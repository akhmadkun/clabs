name: sr-l3vpn
prefix: ""
topology:
  nodes:
    # lo0 : 1.1.1.1/32 vpnv4 peering to pe2
    pe1:
      kind: cisco_xrd
      image: ios-xr/xrd-control-plane:7.11.2
    # lo0 : 3.3.3.3/32
    p3:
      kind: cisco_xrd
      image: ios-xr/xrd-control-plane:7.11.2
    # lo0 : 2.2.2.2/32 vpnv4 peering to pe2
    pe2:
      kind: cisco_xrd
      image: ios-xr/xrd-control-plane:7.11.2

    ce1:
        kind: linux
        image: ghcr.io/srl-labs/network-multitool:latest
        network-mode: none
        exec:
            - ip link set address 00:c1:ab:00:11:11 dev eth1
            - ip addr add 192.168.10.2/24 dev eth1
            - ip route add default via 192.168.10.1
    ce2:
        kind: linux
        image: ghcr.io/srl-labs/network-multitool:latest
        network-mode: none
        exec:
            - ip link set address 00:c1:ab:00:22:22 dev eth1
            - ip addr add 192.168.20.2/24 dev eth1
            - ip route add default via 192.168.20.1
  links:

    # OSPF Area 0 + Segment Routing
    # pe1 - p3 : 10.10.13.0/24
    - endpoints: ["pe1:Gi0-0-0-0", "p3:Gi0-0-0-0"]
    # p3 - pe2 : 10.10.23.0/24
    - endpoints: ["p3:Gi0-0-0-1", "pe2:Gi0-0-0-0"]

    # pe1 - ce1 : 192.168.10.0/24
    - endpoints: ["pe1:Gi0-0-0-1", "ce1:eth1"]

    # pe2 - ce2 : 192.168.20.0/24
    - endpoints: ["pe2:Gi0-0-0-1", "ce2:eth1"]
